import{g as Z,S as ne,e as ie,f as re,P as se,T as G,V as z}from"./index-CLDOAoos.js";var j={exports:{}},J;function oe(){return J||(J=1,function(i){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function r(f,a,s){this.fn=f,this.context=a,this.once=s||!1}function o(f,a,s,l,w){if(typeof s!="function")throw new TypeError("The listener must be a function");var m=new r(s,l||f,w),c=e?e+a:a;return f._events[c]?f._events[c].fn?f._events[c]=[f._events[c],m]:f._events[c].push(m):(f._events[c]=m,f._eventsCount++),f}function h(f,a){--f._eventsCount===0?f._events=new n:delete f._events[a]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var a=[],s,l;if(this._eventsCount===0)return a;for(l in s=this._events)t.call(s,l)&&a.push(e?l.slice(1):l);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(s)):a},u.prototype.listeners=function(a){var s=e?e+a:a,l=this._events[s];if(!l)return[];if(l.fn)return[l.fn];for(var w=0,m=l.length,c=new Array(m);w<m;w++)c[w]=l[w].fn;return c},u.prototype.listenerCount=function(a){var s=e?e+a:a,l=this._events[s];return l?l.fn?1:l.length:0},u.prototype.emit=function(a,s,l,w,m,c){var _=e?e+a:a;if(!this._events[_])return!1;var d=this._events[_],p=arguments.length,g,v;if(d.fn){switch(d.once&&this.removeListener(a,d.fn,void 0,!0),p){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,s),!0;case 3:return d.fn.call(d.context,s,l),!0;case 4:return d.fn.call(d.context,s,l,w),!0;case 5:return d.fn.call(d.context,s,l,w,m),!0;case 6:return d.fn.call(d.context,s,l,w,m,c),!0}for(v=1,g=new Array(p-1);v<p;v++)g[v-1]=arguments[v];d.fn.apply(d.context,g)}else{var E=d.length,b;for(v=0;v<E;v++)switch(d[v].once&&this.removeListener(a,d[v].fn,void 0,!0),p){case 1:d[v].fn.call(d[v].context);break;case 2:d[v].fn.call(d[v].context,s);break;case 3:d[v].fn.call(d[v].context,s,l);break;case 4:d[v].fn.call(d[v].context,s,l,w);break;default:if(!g)for(b=1,g=new Array(p-1);b<p;b++)g[b-1]=arguments[b];d[v].fn.apply(d[v].context,g)}}return!0},u.prototype.on=function(a,s,l){return o(this,a,s,l,!1)},u.prototype.once=function(a,s,l){return o(this,a,s,l,!0)},u.prototype.removeListener=function(a,s,l,w){var m=e?e+a:a;if(!this._events[m])return this;if(!s)return h(this,m),this;var c=this._events[m];if(c.fn)c.fn===s&&(!w||c.once)&&(!l||c.context===l)&&h(this,m);else{for(var _=0,d=[],p=c.length;_<p;_++)(c[_].fn!==s||w&&!c[_].once||l&&c[_].context!==l)&&d.push(c[_]);d.length?this._events[m]=d.length===1?d[0]:d:h(this,m)}return this},u.prototype.removeAllListeners=function(a){var s;return a?(s=e?e+a:a,this._events[s]&&h(this,s)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,i.exports=u}(j)),j.exports}var ae=oe();const ce=Z(ae);var F,Q;function le(){if(Q)return F;Q=1;function i(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var o=t.charAt(r),h=o.charCodeAt(0);if(e[h]!==255)throw new TypeError(o+" is ambiguous");e[h]=r}var u=t.length,f=t.charAt(0),a=Math.log(u)/Math.log(256),s=Math.log(256)/Math.log(u);function l(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length===0)return"";for(var _=0,d=0,p=0,g=c.length;p!==g&&c[p]===0;)p++,_++;for(var v=(g-p)*s+1>>>0,E=new Uint8Array(v);p!==g;){for(var b=c[p],T=0,A=v-1;(b!==0||T<d)&&A!==-1;A--,T++)b+=256*E[A]>>>0,E[A]=b%u>>>0,b=b/u>>>0;if(b!==0)throw new Error("Non-zero carry");d=T,p++}for(var M=v-d;M!==v&&E[M]===0;)M++;for(var U=f.repeat(_);M<v;++M)U+=t.charAt(E[M]);return U}function w(c){if(typeof c!="string")throw new TypeError("Expected String");if(c.length===0)return new Uint8Array;for(var _=0,d=0,p=0;c[_]===f;)d++,_++;for(var g=(c.length-_)*a+1>>>0,v=new Uint8Array(g);c[_];){var E=e[c.charCodeAt(_)];if(E===255)return;for(var b=0,T=g-1;(E!==0||b<p)&&T!==-1;T--,b++)E+=u*v[T]>>>0,v[T]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");p=b,_++}for(var A=g-p;A!==g&&v[A]===0;)A++;for(var M=new Uint8Array(d+(g-A)),U=d;A!==g;)M[U++]=v[A++];return M}function m(c){var _=w(c);if(_)return _;throw new Error("Non-base"+u+" character")}return{encode:l,decodeUnsafe:w,decode:m}}return F=i,F}var P,X;function de(){return X||(X=1,P=le()("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")),P}var he=de();const x=Z(he);let K;const ue=new Uint8Array(16);function fe(){if(!K&&(K=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!K))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return K(ue)}const y=[];for(let i=0;i<256;++i)y.push((i+256).toString(16).slice(1));function ve(i,t=0){return y[i[t+0]]+y[i[t+1]]+y[i[t+2]]+y[i[t+3]]+"-"+y[i[t+4]]+y[i[t+5]]+"-"+y[i[t+6]]+y[i[t+7]]+"-"+y[i[t+8]]+y[i[t+9]]+"-"+y[i[t+10]]+y[i[t+11]]+y[i[t+12]]+y[i[t+13]]+y[i[t+14]]+y[i[t+15]]}const _e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Y={randomUUID:_e};function pe(i,t,e){if(Y.randomUUID&&!t&&!i)return Y.randomUUID();i=i||{};const n=i.random||(i.rng||fe)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ve(n)}function q(i){return i.version===void 0}function R(i){return q(i)?i.serialize({verifySignatures:!1,requireAllSignatures:!1}):i.serialize()}var ee=function(i,t,e,n){function r(o){return o instanceof e?o:new e(function(h){h(o)})}return new(e||(e=Promise))(function(o,h){function u(s){try{a(n.next(s))}catch(l){h(l)}}function f(s){try{a(n.throw(s))}catch(l){h(l)}}function a(s){s.done?o(s.value):r(s.value).then(u,f)}a((n=n.apply(i,t||[])).next())})};function D(i){return ee(this,void 0,void 0,function*(){try{return yield i.request({method:"wallet_getSnaps"}),!0}catch{return!1}})}function me(){return ee(this,void 0,void 0,function*(){try{const i=window.ethereum;if(!i)return null;if(i.providers&&Array.isArray(i.providers)){const t=i.providers;for(const e of t)if(yield D(e))return e}if(i.detected&&Array.isArray(i.detected)){const t=i.detected;for(const e of t)if(yield D(e))return e}return(yield D(i))?i:null}catch(i){return console.error(i),null}})}const ge="solana:mainnet",we="solana:devnet",ye="solana:testnet",be="solana:localnet",te=[ge,we,ye,be];function $(i){return te.includes(i)}var C=function(i,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(i):n?n.value:t.get(i)},I=function(i,t,e,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?i!==t||!r:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(i,e):r?r.value=e:t.set(i,e),e},O,k,N,L,H,W;const Ee=te,Ae=[ne,ie,re];class V{get address(){return C(this,O,"f")}get publicKey(){return C(this,k,"f").slice()}get chains(){return C(this,N,"f").slice()}get features(){return C(this,L,"f").slice()}get label(){return C(this,H,"f")}get icon(){return C(this,W,"f")}constructor({address:t,publicKey:e,label:n,icon:r}){O.set(this,void 0),k.set(this,void 0),N.set(this,void 0),L.set(this,void 0),H.set(this,void 0),W.set(this,void 0),new.target===V&&Object.freeze(this),I(this,O,t,"f"),I(this,k,e,"f"),I(this,N,Ee,"f"),I(this,L,Ae,"f"),I(this,H,n,"f"),I(this,W,r,"f")}}O=new WeakMap,k=new WeakMap,N=new WeakMap,L=new WeakMap,H=new WeakMap,W=new WeakMap;var S=function(i,t,e,n){function r(o){return o instanceof e?o:new e(function(h){h(o)})}return new(e||(e=Promise))(function(o,h){function u(s){try{a(n.next(s))}catch(l){h(l)}}function f(s){try{a(n.throw(s))}catch(l){h(l)}}function a(s){s.done?o(s.value):r(s.value).then(u,f)}a((n=n.apply(i,t||[])).next())})};class B extends ce{constructor(t){super(),this._network="mainnet-beta",this._iframeParams={},this._element=null,this._iframe=null,this._publicKey=null,this._account=null,this._isConnected=!1,this._connectHandler=null,this._messageHandlers={},this._handleEvent=e=>{var n,r;switch(e.type){case"connect":{this._collapseIframe(),!((n=e.data)===null||n===void 0)&&n.publicKey?(this._publicKey=e.data.publicKey,this._isConnected=!0,this._connectHandler&&(this._connectHandler.resolve(),this._connectHandler=null),this._connected()):(this._connectHandler&&(this._connectHandler.reject(),this._connectHandler=null),this._disconnected());return}case"disconnect":{this._connectHandler&&(this._connectHandler.reject(),this._connectHandler=null),this._disconnected();return}case"accountChanged":{!((r=e.data)===null||r===void 0)&&r.publicKey?(this._publicKey=e.data.publicKey,this.emit("accountChanged",this.publicKey),this._standardConnected()):(this.emit("accountChanged",void 0),this._standardDisconnected());return}default:return}},this._handleResize=e=>{e.resizeMode==="full"?e.params.mode==="fullscreen"?this._expandIframe():e.params.mode==="hide"&&this._collapseIframe():e.resizeMode==="coordinates"&&this._resizeIframe(e.params)},this._handleMessage=e=>{var n;if(((n=e.data)===null||n===void 0?void 0:n.channel)!=="solflareIframeToWalletAdapter")return;const r=e.data.data||{};if(r.type==="event")this._handleEvent(r.event);else if(r.type==="resize")this._handleResize(r);else if(r.type==="response"&&this._messageHandlers[r.id]){const{resolve:o,reject:h}=this._messageHandlers[r.id];delete this._messageHandlers[r.id],r.error?h(r.error):o(r.result)}},this._removeElement=()=>{this._element&&(this._element.remove(),this._element=null)},this._removeDanglingElements=()=>{const e=document.getElementsByClassName("solflare-metamask-wallet-adapter-iframe");for(const n of e)n.parentElement&&n.remove()},this._injectElement=()=>{this._removeElement(),this._removeDanglingElements();const e=Object.assign(Object.assign({},this._iframeParams),{mm:!0,v:1,cluster:this._network||"mainnet-beta",origin:window.location.origin||"",title:document.title||""}),n=Object.keys(e).map(o=>`${o}=${encodeURIComponent(e[o])}`).join("&"),r=`${B.IFRAME_URL}?${n}`;this._element=document.createElement("div"),this._element.className="solflare-metamask-wallet-adapter-iframe",this._element.innerHTML=`
      <iframe src='${r}' style='position: fixed; top: 0; bottom: 0; left: 0; right: 0; width: 100%; height: 100%; border: none; border-radius: 0; z-index: 99999; color-scheme: auto;' allowtransparency='true'></iframe>
    `,document.body.appendChild(this._element),this._iframe=this._element.querySelector("iframe"),window.addEventListener("message",this._handleMessage,!1)},this._collapseIframe=()=>{this._iframe&&(this._iframe.style.top="",this._iframe.style.right="",this._iframe.style.height="2px",this._iframe.style.width="2px")},this._expandIframe=()=>{this._iframe&&(this._iframe.style.top="0px",this._iframe.style.bottom="0px",this._iframe.style.left="0px",this._iframe.style.right="0px",this._iframe.style.width="100%",this._iframe.style.height="100%")},this._resizeIframe=e=>{this._iframe&&(this._iframe.style.top=isFinite(e.top)?`${e.top}px`:"",this._iframe.style.bottom=isFinite(e.bottom)?`${e.bottom}px`:"",this._iframe.style.left=isFinite(e.left)?`${e.left}px`:"",this._iframe.style.right=isFinite(e.right)?`${e.right}px`:"",this._iframe.style.width=isFinite(e.width)?`${e.width}px`:e.width,this._iframe.style.height=isFinite(e.height)?`${e.height}px`:e.height)},this._sendIframeMessage=e=>{if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");return new Promise((n,r)=>{var o,h;const u=pe();this._messageHandlers[u]={resolve:n,reject:r},(h=(o=this._iframe)===null||o===void 0?void 0:o.contentWindow)===null||h===void 0||h.postMessage({channel:"solflareWalletAdapterToIframe",data:Object.assign({id:u},e)},"*")})},this._connected=()=>{this._isConnected=!0,this.emit("connect",this.publicKey),this._standardConnected()},this._disconnected=()=>{this._publicKey=null,this._isConnected=!1,window.removeEventListener("message",this._handleMessage,!1),this._removeElement(),this.emit("disconnect"),this._standardDisconnected()},this._standardConnected=()=>{if(!this.publicKey)return;const e=this.publicKey.toString();(!this._account||this._account.address!==e)&&(this._account=new V({address:e,publicKey:this.publicKey.toBytes()}),this.emit("standard_change",{accounts:this.standardAccounts}))},this._standardDisconnected=()=>{this._account&&(this._account=null,this.emit("standard_change",{accounts:this.standardAccounts}))},t!=null&&t.network&&(this._network=t==null?void 0:t.network),window.SolflareMetaMaskParams&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),window.SolflareMetaMaskParams)),t!=null&&t.params&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),t==null?void 0:t.params))}get publicKey(){return this._publicKey?new se(this._publicKey):null}get standardAccount(){return this._account}get standardAccounts(){return this._account?[this._account]:[]}get isConnected(){return this._isConnected}get connected(){return this.isConnected}get autoApprove(){return!1}connect(){return S(this,void 0,void 0,function*(){this.connected||(this._injectElement(),yield new Promise((t,e)=>{this._connectHandler={resolve:t,reject:e}}))})}disconnect(){return S(this,void 0,void 0,function*(){yield this._sendIframeMessage({method:"disconnect"}),this._disconnected()})}signTransaction(t){var e;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const n=R(t),r=yield this._sendIframeMessage({method:"signTransactionV2",params:{transaction:x.encode(n)}}),{transaction:o}=r;return q(t)?G.from(x.decode(o)):z.deserialize(x.decode(o))}catch(n){throw new Error(((e=n==null?void 0:n.toString)===null||e===void 0?void 0:e.call(n))||"Failed to sign transaction")}})}signAllTransactions(t){var e;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const n=t.map(o=>R(o)),{transactions:r}=yield this._sendIframeMessage({method:"signAllTransactionsV2",params:{transactions:n.map(o=>x.encode(o))}});return r.map((o,h)=>q(t[h])?G.from(x.decode(o)):z.deserialize(x.decode(o)))}catch(n){throw new Error(((e=n==null?void 0:n.toString)===null||e===void 0?void 0:e.call(n))||"Failed to sign transactions")}})}signAndSendTransaction(t,e){var n;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const r=R(t),{signature:o}=yield this._sendIframeMessage({method:"signAndSendTransaction",params:{transaction:x.encode(r),options:e}});return o}catch(r){throw new Error(((n=r==null?void 0:r.toString)===null||n===void 0?void 0:n.call(r))||"Failed to sign and send transaction")}})}signMessage(t,e="utf8"){var n;return S(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw new Error("Wallet not connected");try{const{signature:r}=yield this._sendIframeMessage({method:"signMessage",params:{data:x.encode(t),display:e}});return Uint8Array.from(x.decode(r))}catch(r){throw new Error(((n=r==null?void 0:r.toString)===null||n===void 0?void 0:n.call(r))||"Failed to sign message")}})}sign(t,e="utf8"){return S(this,void 0,void 0,function*(){return yield this.signMessage(t,e)})}static isSupported(){return S(this,void 0,void 0,function*(){return!!(yield me())})}standardSignAndSendTransaction(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{transaction:n,account:r,chain:o,options:h}=t[0],{minContextSlot:u,preflightCommitment:f,skipPreflight:a,maxRetries:s}=h||{};if(r!==this._account)throw new Error("invalid account");if(!$(o))throw new Error("invalid chain");const l=yield this.signAndSendTransaction(z.deserialize(n),{preflightCommitment:f,minContextSlot:u,maxRetries:s,skipPreflight:a});e.push({signature:x.decode(l)})}else if(t.length>1)for(const n of t)e.push(...yield this.standardSignAndSendTransaction(n));return e})}standardSignTransaction(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{transaction:n,account:r,chain:o}=t[0];if(r!==this._account)throw new Error("invalid account");if(o&&!$(o))throw new Error("invalid chain");const h=yield this.signTransaction(z.deserialize(n));e.push({signedTransaction:h.serialize()})}else if(t.length>1){let n;for(const h of t){if(h.account!==this._account)throw new Error("invalid account");if(h.chain){if(!$(h.chain))throw new Error("invalid chain");if(n){if(h.chain!==n)throw new Error("conflicting chain")}else n=h.chain}}const r=t.map(({transaction:h})=>z.deserialize(h)),o=yield this.signAllTransactions(r);e.push(...o.map(h=>({signedTransaction:h.serialize()})))}return e})}standardSignMessage(...t){return S(this,void 0,void 0,function*(){if(!this.connected)throw new Error("not connected");const e=[];if(t.length===1){const{message:n,account:r}=t[0];if(r!==this._account)throw new Error("invalid account");const o=yield this.signMessage(n);e.push({signedMessage:n,signature:o})}else if(t.length>1)for(const n of t)e.push(...yield this.standardSignMessage(n));return e})}}B.IFRAME_URL="https://widget.solflare.com/";export{V as StandardSolflareMetaMaskWalletAccount,B as default};
